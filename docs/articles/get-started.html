<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>get-started â€¢ socialroulette</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="get-started">
<meta property="og:description" content="socialroulette">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">socialroulette</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/get-started.html">get-started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="get-started_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>get-started</h1>
            
      
      
      <div class="hidden name"><code>get-started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <code>socialroulette</code> R package is a lightweight package for handling the recurrent problem of assigning individuals into groups of a fixed size. This happens, e.g., as part of <a href="https://hbr.org/2013/01/a-new-way-to-network-inside-yo">mystery lunch</a> scheduling or when assigning students into breakout rooms in video lectures. The work on the package was inspired by the blog post <a href="https://staff.math.su.se/hoehle/blog/2021/04/04/socialsamp.html">Long time, no see: Virtual Lunch Roulette</a>,</p>
</div>
<div id="the-problem" class="section level2">
<h2 class="hasAnchor">
<a href="#the-problem" class="anchor"></a>The Problem</h2>
<p>The aim is to assign <span class="math inline">\(n\)</span> participants into groups of size at least <span class="math inline">\(m\)</span>. If <span class="math inline">\(m\)</span> is not a divisor of <span class="math inline">\(n\)</span> then some of the groups have to contain more than <span class="math inline">\(m\)</span> participants. As an example consider the scenario that 5 individuals have to be divided into groups of size at least 2. We shall adopt the convention, that group size shall be as close to <span class="math inline">\(m\)</span> as possible and the group sizes should be as equal as possible. In the specific toy example this means that we will need 2 groups, one with 3 participants and one with 2 participants.</p>
<p><strong>Remark</strong>: Partitions with <span class="math inline">\(m=2\)</span> are also known as a <a href="https://en.wikipedia.org/wiki/Matching_(graph_theory)">matchings</a> and can be handled particularly efficient using special-purpose graph algorithms. However, we use the <span class="math inline">\(m=2\)</span> example in order to illustrate the package functionality with a simple to follow example. Later sections of the vignette contain some more realistic examples with <span class="math inline">\(m&gt;2\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">socialroulette</span><span class="op">)</span>
<span class="va">today</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span> id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"id%.02d"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, date<span class="op">=</span><span class="va">today</span><span class="op">)</span>
<span class="va">round1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rsocialroulette.html">rsocialroulette</a></span><span class="op">(</span>current_frame <span class="op">=</span> <span class="va">frame</span>, m<span class="op">=</span><span class="fl">2</span>, algorithm<span class="op">=</span><span class="st">"srs"</span><span class="op">)</span>
<span class="co">#&gt; Partitioning 5 individuals into groups of at least 2 (no past sessions).</span>
<span class="co">#&gt; Created 2 groups of sizes 3 2.</span>
<span class="va">round1</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "id01" "id03" "id05"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "id02" "id04"</span></code></pre></div>
<p>An extension of this grouping problem occurs if we keep track of how participants were partitioned into groups the last time. It can be <a href="https://staff.math.su.se/hoehle/blog/2021/04/04/socialsamp.html">shown</a>, that simple random sampling leads to quite high reunion probabilities. As an example: the probability to end up in the same group with at least one participant from last week when 50 individuals are partitioned into groups of <span class="math inline">\(m=4\)</span> is about 20%. In order to improve on this, one can either use rejection sampling or a solver of the maximally diverse grouping problem.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#List of past partitions</span>
<span class="va">past_sessions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">round1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">today</span><span class="op">)</span>
<span class="co">#Same individuals one week later</span>
<span class="va">frame2</span> <span class="op">&lt;-</span> <span class="va">frame</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="va">today</span><span class="op">+</span><span class="fl">7</span><span class="op">)</span>
<span class="co">#Check for each possible pair in frame2 how long ago (in days) it would be that they met. </span>
<span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/sessions_to_distance.html">sessions_to_distance</a></span><span class="op">(</span><span class="va">frame2</span>, <span class="va">past_sessions</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 4</span>
<span class="co">#&gt;    id1   id2   date        dist</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;date&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 id01  id02  2021-05-05    14</span>
<span class="co">#&gt;  2 id01  id03  2021-05-05     7</span>
<span class="co">#&gt;  3 id01  id04  2021-05-05    14</span>
<span class="co">#&gt;  4 id01  id05  2021-05-05     7</span>
<span class="co">#&gt;  5 id02  id03  2021-05-05    14</span>
<span class="co">#&gt;  6 id02  id04  2021-05-05     7</span>
<span class="co">#&gt;  7 id02  id05  2021-05-05    14</span>
<span class="co">#&gt;  8 id03  id04  2021-05-05    14</span>
<span class="co">#&gt;  9 id03  id05  2021-05-05     7</span>
<span class="co">#&gt; 10 id04  id05  2021-05-05    14</span></code></pre></div>
<p>For comparison, we now use maximally diverse grouping problem solver on the same toy example. This corresponds to taking a sledgehammer to crush a nut, but helps to show how the package works:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">round2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rsocialroulette.html">rsocialroulette</a></span><span class="op">(</span>current_frame <span class="op">=</span> <span class="va">frame2</span>, past_sessions<span class="op">=</span><span class="va">past_sessions</span>, m<span class="op">=</span><span class="fl">2</span>, algorithm<span class="op">=</span><span class="st">"mdgp"</span><span class="op">)</span>
<span class="co">#&gt; Parsed with column specification:</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   id_int = col_character(),</span>
<span class="co">#&gt;   group = col_character()</span>
<span class="co">#&gt; )</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">round2</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "id01" "id02" "id05"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "id03" "id04"</span></code></pre></div>
<p>Using this partitions we get the following re-unions, i.e.Â pairs of individuals which in round 2 meet again, despite already being in the same group in round 1. Note that it is easy to show that with 5 participants and <span class="math inline">\(m=2\)</span>, at least one re-union is needed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sessions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>last_week <span class="op">=</span> <span class="va">round1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>this_week <span class="op">=</span> <span class="va">round2</span><span class="op">)</span><span class="op">)</span>
<span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">sessions</span>, <span class="op">~</span> <span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/sessions_to_pairs.html">sessions_to_pairs</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>
<span class="fu">inner_join</span><span class="op">(</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">pairs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id1"</span>, <span class="st">"id2"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   date.x    id1   id2   date.y   </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1 last_week id01  id05  this_week</span></code></pre></div>
</div>
<div id="a-more-complex-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-more-complex-example" class="anchor"></a>A more complex example</h2>
<p>We continue with a slightly more advanced example, where we have a class with 100 students, which for a weekly virtual lab exercise class need to be divided into groups of at least 4. Since for various reasons not all students show up to each class, the sampling frame of individuals to be partitioned each week changes accordingly. Still, we would like to make the partitioning of the current week s.t. students get as many new acquaintances as possible.</p>
<p>Create a history of previous sessions as well as the current frame from a population of 100 individuals participating in the social roulette.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Class of 100 students with 4 previous lectures</span>
<span class="va">students</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"id%.3d@student.su.se"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">session_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2021-03-31"</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">4</span>, by<span class="op">=</span><span class="st">"1 week"</span><span class="op">)</span>

<span class="co"># Simulate changing participation each week for the last 4 weeks (70% attendance)</span>
<span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span> <span class="va">session_dates</span>, <span class="op">~</span> 
            <span class="va">students</span> <span class="op">%&gt;%</span> <span class="fu">slice_sample</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, prob<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>date<span class="op">=</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Generate some past sessions using simple random sampling</span>
<span class="va">past_sessions</span> <span class="op">&lt;-</span> <span class="va">frames</span> <span class="op">%&gt;%</span> 
   <span class="fu">group_split</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="../reference/rsocialroulette.html">rsocialroulette</a></span><span class="op">(</span>current_frame<span class="op">=</span><span class="va">.x</span>, m<span class="op">=</span><span class="fl">4</span>, algorithm<span class="op">=</span><span class="st">"srs"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">session_dates</span><span class="op">)</span>
<span class="co">#&gt; Partitioning 61 individuals into groups of at least 4 (no past sessions).</span>
<span class="co">#&gt; Created 15 groups of sizes 5 4 4 4 4 4 4 4 4 4 4 4 4 4 4.</span>
<span class="co">#&gt; Partitioning 72 individuals into groups of at least 4 (no past sessions).</span>
<span class="co">#&gt; Created 18 groups of sizes 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4.</span>
<span class="co">#&gt; Partitioning 70 individuals into groups of at least 4 (no past sessions).</span>
<span class="co">#&gt; Created 17 groups of sizes 5 5 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4.</span>
<span class="co">#&gt; Partitioning 76 individuals into groups of at least 4 (no past sessions).</span>
<span class="co">#&gt; Created 19 groups of sizes 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4.</span></code></pre></div>
<p>For a more realist scenario, we pretend that each previous session has been saved as a .csv file. For example like:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulate the storage of each partition as a .csv file to disk</span>
<span class="co"># with 3 columns: date, id1 and id2, i.e. all pairs</span>
<span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#adjust path to your setting if needed</span>
<span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/sessions_to_pairs.html">sessions_to_pairs</a></span><span class="op">(</span> <span class="va">past_sessions</span> <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_split</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">walk</span><span class="op">(</span><span class="op">~</span>  <span class="fu">write_csv</span><span class="op">(</span>x<span class="op">=</span><span class="va">.x</span>, path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="fu">str_c</span><span class="op">(</span><span class="st">"socialroulette-"</span>, <span class="va">.</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We thus read the partitions from disk and need to convert between the stored pair format (i.e.Â a data.frame listing each pair being in the same group as id1, id2 together with the corresponding date) back to the partition list format. This can be done as follows</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read again from file</span>
<span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu">map_df</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">temp_dir</span>, pattern<span class="op">=</span><span class="st">"socialroulette.*"</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="op">~</span><span class="fu">read_csv</span><span class="op">(</span>file<span class="op">=</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>A small sanity check to ensure that the write and read did not really change any information:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert into a pairs data.frame </span>
<span class="va">past_sessions2</span> <span class="op">&lt;-</span> <span class="va">pairs</span> <span class="op">%&gt;%</span> <span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/pairs_to_session.html">pairs_to_session</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Sanity check</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">past_sessions</span>, <span class="va">past_sessions2</span><span class="op">)</span>  
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Everything is thus now in place to generate the partition:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Who is in the next class?</span>
<span class="va">current_frame</span> <span class="op">&lt;-</span>  <span class="va">students</span> <span class="op">%&gt;%</span> <span class="fu">slice_sample</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, prob<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">session_dates</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">session_dates</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Make the partition, which tries to bring together those who have not met in a long time</span>
<span class="va">partition</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/rsocialroulette.html">rsocialroulette</a></span><span class="op">(</span><span class="va">current_frame</span>, <span class="va">past_sessions</span>, m<span class="op">=</span><span class="fl">4</span>, algorithm<span class="op">=</span><span class="st">"mdgp"</span><span class="op">)</span></code></pre></div>
<p>The partition can be visualized using the <code>igraph</code> package: <img src="get-started_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Of course the partition can be stored to file as before in order to include it in the past partitions next week:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">partition</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">current_frame</span> <span class="op">%&gt;%</span> <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/sessions_to_pairs.html">sessions_to_pairs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">write_csv</span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="fu">str_c</span><span class="op">(</span><span class="st">"socialroulette-"</span>, <span class="va">.</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">".csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>or can be stored in a Zoom compatible breakout room specification format:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">partition</span> <span class="op">%&gt;%</span> 
  <span class="fu">socialroulette</span><span class="fu">:::</span><span class="fu"><a href="../reference/partitionList_to_frame.html">partitionList_to_frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span>email<span class="op">=</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>room <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"room%.03d"</span>,<span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">room</span>, <span class="va">email</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">write_csv</span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="fu">str_c</span><span class="op">(</span><span class="st">"zoom-breakoutrooms.csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael HÃ¶hle, Jin-Kao Hao, Xiangjing Lai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
